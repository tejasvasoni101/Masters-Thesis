%lattice absorption

function [ep,n,k] = Palik_SiC(lambda)
      A=[6.0	2.404	6.21E-3
6.1     2.404	1.46E-3
6.2 	2.404	1.92E-2
6.25	2.372   1.92E-2
6.3 	2.372	9.53E-3
6.4 	2.372	1.02E-2
6.5 	2.372	2.59E-2
6.6 	2.372	2.10E-2
6.667	2.328	2.10E-2
6.7 	2.328	3.20E-3
6.8 	2.328	1.62E-3
6.9 	2.328	3.07E-3
7.0 	2.328	5.57E-3
7.1 	2.328	7.91E-3
7.143	2.267	7.91E-3
7.2 	2.267	8.59E-3
7.3 	2.267	8.71E-3
7.4 	2.267	1.06E-2
7.5 	2.267	1.43E-2
7.6 	2.267	1.69E-2
7.692	2.178	1.69E-2
7.7 	2.178	1.59E-2
7.8 	2.178	1.24E-2
7.9 	2.178	9.43E-3
8.0 	2.178	8.28E-3
8.2 	2.178	7.96E-3
8.333  	2.034	7.96E-3
8.4 	2.034	8.96E-3
8.6 	2.034	1.03E-2
8.8 	2.034	1.11E-02
9.0 	2.034	1.15E-02
9.091	1.768	1.15E-02
9.2 	1.768	1.16E-02
9.259	1.684	1.16E-02
9.4 	1.684	1.14E-02
9.434	1.581	1.14E-02
9.6 	1.581	1.15E-02
9.615	1.453	1.15E-02
9.8 	1.286	1.40E-02
10  	1.051	3.40E-2
10.1	0.888	4.50E-02
10.2	0.663	6.70E-02
10.31	0.274	0.18
10.42	0.0872	0.63
10.53	0.0663	0.95
10.64	0.0593	1.21
10.75	0.0569	1.45
10.87	0.0569	1.69
10.99	0.0587	1.93
11.11	0.0621	2.18
11.24	0.0672	2.45
11.36	0.0746	2.75
11.49	0.0850	3.08
11.63	0.0999	3.47
11.76	0.122	3.93
11.90	0.156	4.51
12.05	0.215	5.27
12.12	0.262	5.77
12.20	0.332	6.38
12.27	0.443	7.18
12.35	0.639	8.27
12.42	1.05	9.93
12.50	2.22	12.8
12.58	8.74	18.4
12.66	17.7	6.03
12.74	12.7	1.76
12.82	10.3	0.868
12.90	8.91	0.531
12.99	8   	0.364
13.07	7.35	0.268
13.16	6.86	0.208
13.33	6.16	0.136
13.51	5.68	9.70E-02
13.70	5.32	7.40E-02
13.89	5.05	5.80E-02
14.08	4.83	4.70E-02
14.29	4.65	3.90E-02
15.38	4.09	1.80E-02
16.67	3.80	1.10E-02
18.18	3.61	1.10E-02
20.00	3.49	1.10E-02
22.22	3.40	1.10E-02
25.00	3.34	1.10E-02
];

        Palik_lam=A(:,1);
        Palik_kap=A(:,3);
        Palik_ref=A(:,2);
        
        if lambda<Palik_lam(1) || lambda>Palik_lam(length(Palik_lam))
            y=0;
        else
            ind=find(Palik_lam>=lambda);
            wave_R=Palik_lam(ind(1));
            if ind(1)==1
                n=Palik_ref(1);
                k=Palik_kap(1);
            else
                wave_L=Palik_lam(ind(1)-1);
                n=(Palik_ref(ind(1))-Palik_ref(ind(1)-1))/(wave_R-wave_L)*(lambda-wave_L)+Palik_ref(ind(1)-1);
                k=(Palik_kap(ind(1))-Palik_kap(ind(1)-1))/(wave_R-wave_L)*(lambda-wave_L)+Palik_kap(ind(1)-1);
            end
        end
        
        ep = (n+i*k)^2;
