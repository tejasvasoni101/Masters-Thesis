
%lattice absorption
% Smooth curve modified by zz

function ep = Palik_Au(lambda)
      A=[0.2	1.427	1.125
        0.2066	1.422	1.306
        0.2101	1.43	1.334
        0.2138	1.432	1.364
        0.2175	1.438	1.388
        0.2214	1.442	1.418
        0.2254	1.452	1.442
        0.2296	1.454	1.478
        0.2339	1.462	1.51
        0.2384	1.47	1.55
        0.2431	1.478	1.59
        0.248	1.484	1.636
        0.253	1.49	1.698
        0.2583	1.504	1.748
        0.2638	1.546	1.784
        0.2695	1.598	1.822
        0.2755	1.648	1.852
        0.2818	1.69	1.882
        0.2883	1.742	1.9
        0.2952	1.776	1.918
        0.3024	1.812	1.92
        0.31	1.83	1.916
        0.3179	1.84	1.904
        0.3263	1.824	1.878
        0.3351	1.798	1.86
        0.3444	1.766	1.846
        0.3542	1.74	1.848
        0.3647	1.716	1.862
        0.3757	1.696	1.906
        0.3875	1.674	1.936
        0.4     1.658	1.956
        0.4133	1.636	1.958
        0.4275	1.616	1.94
        0.4428	1.562	1.904
        0.4592	1.426	1.846
        0.4769	1.242	1.796
        0.4959	0.916	1.84
        0.5166	0.608	2.12
        0.5391	0.402	2.54
        0.5636	0.306	2.88
        0.5904	0.236	2.961303371
        0.6199	0.194	3.050797753
        0.6526	0.166	3.15
        0.6888	0.16	3.8
        0.7293	0.164	4.35
        0.7749	0.174	4.86
        0.8266	0.188	5.39
        0.8856	0.21	5.88
        0.9537	0.236	6.47
        1.033	0.272	7.07
        1.265	0.389	8.09
        1.291	0.403	8.25
        1.319	0.419	8.42
        1.348	0.436	8.59
        1.378	0.454	8.77
        1.409	0.473	8.96
        1.442	0.493	9.15
        1.476	0.515	9.36
        1.512	0.537	9.58
        1.55	0.559	9.81
        1.59	0.583	10.1
        1.631	0.609	10.3
        1.675	0.636	10.6
        1.722	0.665	10.9
        1.771	0.696	11.2
        1.823	0.73	11.5
        1.879	0.767	11.9
        1.937	0.807	12.2
        2       0.85	12.6
        2.066	0.896	13
        2.138	0.947	13.4
        2.214	1.002	13.9
        2.296	1.063	14.4
        2.384	1.13	14.9
        2.48	1.205	15.5
        2.583	1.287	16.1
        2.695	1.379	16.8
        2.818	1.482	17.5
        2.952	1.598	18.3
        3.1     1.728	19.2
        3.179	1.8     19.7
        3.263	1.876	20.2
        3.351	1.958	20.7
        3.444	2.046	21.3
        3.542	2.141	21.9
        3.647	2.242	22.5
        3.757	2.352	23.1
        3.875	2.471	23.9
        4       2.6     24.6
        4.133	2.749	25.4
        4.275	2.912	26.3
        4.428	3.091	27.2
        4.592	3.289	28.2
        4.769	3.507	29.3
        4.959	3.748	30.5
        5.166	4.007	31.7
        5.391	4.292	32.9
        5.636	4.611	34.3
        5.904	4.971	35.9
        6.199	5.423	37.5
        6.358	5.684	38.3
        6.526	5.966	39.1
        6.702	6.27	40.1
        6.888	6.598	41
        7.085	6.937	42
        7.293	7.282	43
        7.514	7.655	44.1
        7.749	8.06	45.2
        7.999	8.5     46.4
        8.266	9.016	47.6
        8.551	9.582	48.8
        8.856	10.21	50.2
        9.184	10.84	51.6
        9.537	11.51	53.1
        9.919	12.24	54.7];

        Palik_lam=A(:,1);
        Palik_kap=A(:,3);
        Palik_ref=A(:,2);
        
        if lambda<Palik_lam(1) || lambda>Palik_lam(length(Palik_lam))
            y=0;
        else
            ind=find(Palik_lam>=lambda);
            wave_R=Palik_lam(ind(1));
            if ind(1)==1
                n=Palik_ref(1);
                k=Palik_kap(1);
            else
                wave_L=Palik_lam(ind(1)-1);
                n=(Palik_ref(ind(1))-Palik_ref(ind(1)-1))/(wave_R-wave_L)*(lambda-wave_L)+Palik_ref(ind(1)-1);
                k=(Palik_kap(ind(1))-Palik_kap(ind(1)-1))/(wave_R-wave_L)*(lambda-wave_L)+Palik_kap(ind(1)-1);
            end
            
        end
        ep = (n+i*k)^2;
        clear n k;
        

